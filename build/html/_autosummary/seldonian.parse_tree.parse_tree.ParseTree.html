
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>seldonian.parse_tree.parse_tree.ParseTree &#8212; Seldonian Engine pre-release documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="seldonian.safety_test" href="seldonian.safety_test.html" />
    <link rel="prev" title="seldonian.parse_tree.parse_tree" href="seldonian.parse_tree.parse_tree.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="seldonian-parse-tree-parse-tree-parsetree">
<h1>seldonian.parse_tree.parse_tree.ParseTree<a class="headerlink" href="#seldonian-parse-tree-parse-tree-parsetree" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seldonian.parse_tree.parse_tree.</span></span><span class="sig-name descname"><span class="pre">ParseTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to represent a parse tree for a single behavioral constraint</p>
<dl class="simple">
<dt>root<span class="classifier">nodes.Node class instance</span></dt><dd><p>Root node which contains the whole tree 
via left and right child attributes.
Gets assigned when tree is built</p>
</dd>
<dt>constraint_str: str</dt><dd><p>The string expression for the behavioral
constraint</p>
</dd>
<dt>delta: float</dt><dd><p>Confidence level. Specifies the maximum probability 
that the algorithm can return a solution violat the
behavioral constraint.</p>
</dd>
<dt>n_nodes: int</dt><dd><p>Total number of nodes in the parse tree</p>
</dd>
<dt>n_base_nodes: int</dt><dd><p>Number of base variable nodes in the parse tree.
Does not include constants. If a base variable,
such as PR | [M] appears more than once in the 
constraint_str each appearance contributes 
to n_base_nodes</p>
</dd>
<dt>base_node_dict: dict</dt><dd><p>Keeps track of unique base variable nodes,
their confidence bounds and whether 
the bounds have been calculated
for a given base node already.
Helpful for handling case where we have 
duplicate base nodes</p>
</dd>
<dt>node_fontsize: int</dt><dd><p>Fontsize used for graphviz visualizations</p>
</dd>
</dl>
<dl class="simple">
<dt>create_from_ast(s)</dt><dd><p>Create the node structure of the tree
given a mathematical string expression
for the behavioral constraint, s</p>
</dd>
<dt>_ast_tree_helper(ast_node)</dt><dd><p>Helper function for create_from_ast()</p>
</dd>
<dt>_ast2pt_node(ast_node)</dt><dd><p>Mapper between python’s ast library’s
node objects to this library’s Node objects</p>
</dd>
<dt>assign_deltas(weight_method)</dt><dd><p>Assign the delta values to the base nodes in the tree</p>
</dd>
<dt>_assign_deltas_helper(node,weight_method)</dt><dd><p>Helper function for assign_deltas()</p>
</dd>
<dt>assign_bounds_needed()</dt><dd><p>Assign whether lower, upper or both bounds
need to be calculated for each node.</p>
</dd>
<dt>_assign_bounds_helper()</dt><dd><p>Helper function for assign_bounds_needed</p>
</dd>
<dt>propagate_bounds()</dt><dd><p>Traverse the parse tree, calculate confidence
bounds on base nodes and 
then propagate bounds using propagation logic</p>
</dd>
<dt>_propagator_helper(node)</dt><dd><p>Helper function for propagate_bounds()</p>
</dd>
<dt>evaluate_constraint()</dt><dd><p>Get the mean value of the constraint,
given a dataset and model</p>
</dd>
<dt>_evaluator_helper(node)</dt><dd><p>Helper function for evaluate_constraint()</p>
</dd>
<dt>_propagate_value(node)</dt><dd><p>Given an internal node, calculate the 
propagated node value from its children 
using the node’s operator type</p>
</dd>
<dt>_protect_nan(bound,bound_type)</dt><dd><p>Handle nan as negative infinity if in lower bound
and postitive infinity if in upper bound</p>
</dd>
<dt>_propagate(node)</dt><dd><p>Given an internal node, calculate 
the propagated confidence interval
from its children using the 
node’s operator type</p>
</dd>
<dt>_add(a,b)</dt><dd><p>Add intervals a and b</p>
</dd>
<dt>_sub(a,b)</dt><dd><p>Subtract intervals a and b</p>
</dd>
<dt>_mult(a,b)</dt><dd><p>Multiply intervals a and b</p>
</dd>
<dt>_div(a,b)</dt><dd><p>Divide intervals a and b</p>
</dd>
<dt>_pow(a,b)</dt><dd><p>Raise interval a to the power of interval b 
(experimental feature)</p>
</dd>
<dt>_min(a,b)</dt><dd><p>Get the minimum interval from intervals a and b</p>
</dd>
<dt>_max(a,b)</dt><dd><p>Get the maximum interval from intervals a and b</p>
</dd>
<dt>_abs(a)</dt><dd><p>Take the absolute value of interval a</p>
</dd>
<dt>_exp(a)</dt><dd><p>Calculate e raised to the interval a.</p>
</dd>
</dl>
<p>reset_base_node_dict(reset_data=False)</p>
<dl class="simple">
<dt>make_viz(title)</dt><dd><p>Make a graphviz graph object of 
the parse tree and give it a title</p>
</dd>
<dt>make_viz_helper(root,graph)</dt><dd><p>Helper function for make_viz()</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.__init__" title="seldonian.parse_tree.parse_tree.ParseTree.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(delta)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.assign_bounds_needed" title="seldonian.parse_tree.parse_tree.ParseTree.assign_bounds_needed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_bounds_needed</span></code></a>(**kwargs)</p></td>
<td><p>BFS through the tree and decide which bounds are required to compute on each child node.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.assign_deltas" title="seldonian.parse_tree.parse_tree.ParseTree.assign_deltas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_deltas</span></code></a>([weight_method])</p></td>
<td><p>Assign the delta values to the base nodes in the tree.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.create_from_ast" title="seldonian.parse_tree.parse_tree.ParseTree.create_from_ast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_from_ast</span></code></a>(s)</p></td>
<td><p>Create the node structure of the tree given a mathematical string expression, s</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.evaluate_constraint" title="seldonian.parse_tree.parse_tree.ParseTree.evaluate_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_constraint</span></code></a>(**kwargs)</p></td>
<td><p>Evaluate the constraint itself (not <a href="#id1"><span class="problematic" id="id2">bounds_</span></a>) Postorder traverse (left, right, root) through the tree and calculate the values of the base nodes  then propagate bounds using propagation logic</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.make_viz" title="seldonian.parse_tree.parse_tree.ParseTree.make_viz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_viz</span></code></a>(title)</p></td>
<td><p>Make a graphviz diagram from a root node</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.make_viz_helper" title="seldonian.parse_tree.parse_tree.ParseTree.make_viz_helper"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_viz_helper</span></code></a>(root, graph)</p></td>
<td><p>Helper function for make_viz() Recurses through the parse tree and adds nodes and edges to the graph</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.propagate_bounds" title="seldonian.parse_tree.parse_tree.ParseTree.propagate_bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">propagate_bounds</span></code></a>(**kwargs)</p></td>
<td><p>Postorder traverse (left, right, root) through the tree and calculate confidence bounds on base nodes, then propagate bounds using propagation logic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#seldonian.parse_tree.parse_tree.ParseTree.reset_base_node_dict" title="seldonian.parse_tree.parse_tree.ParseTree.reset_base_node_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_base_node_dict</span></code></a>([reset_data])</p></td>
<td><p>Reset base node dict to initial state</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.assign_bounds_needed">
<span class="sig-name descname"><span class="pre">assign_bounds_needed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.assign_bounds_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>BFS through the tree and decide which bounds
are required to compute on each child node.
Eventually we get to base nodes 
There are cases where it is not always 
necessary to compute both lower and upper 
bounds because at the end all we care about
is the upper bound of the root node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.assign_deltas">
<span class="sig-name descname"><span class="pre">assign_deltas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.assign_deltas" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign the delta values to the base nodes in the tree.</p>
<dl class="simple">
<dt>weight_method<span class="classifier">str</span></dt><dd><p>How you want to assign the deltas to the base nodes
‘equal’ : split up delta equally among base nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.create_from_ast">
<span class="sig-name descname"><span class="pre">create_from_ast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.create_from_ast" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the node structure of the tree
given a mathematical string expression, s</p>
<dl class="simple">
<dt>s<span class="classifier">str</span></dt><dd><p>mathematical expression written in Python syntax
from which we build the parse tree</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.evaluate_constraint">
<span class="sig-name descname"><span class="pre">evaluate_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.evaluate_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the constraint itself (not <a href="#id3"><span class="problematic" id="id4">bounds_</span></a>)
Postorder traverse (left, right, root)
through the tree and calculate the values
of the base nodes 
then propagate bounds using propagation logic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.make_viz">
<span class="sig-name descname"><span class="pre">make_viz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.make_viz" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a graphviz diagram from a root node</p>
<dl class="simple">
<dt>title<span class="classifier">str</span></dt><dd><p>The title you want to display at the top
of the graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.make_viz_helper">
<span class="sig-name descname"><span class="pre">make_viz_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.make_viz_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for make_viz()
Recurses through the parse tree
and adds nodes and edges to the graph</p>
<dl class="simple">
<dt>root<span class="classifier">nodes.Node class instance</span></dt><dd><p>root of the parse tree</p>
</dd>
<dt>graph: graphviz.Digraph class instance</dt><dd><p>The graphviz graph object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.propagate_bounds">
<span class="sig-name descname"><span class="pre">propagate_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.propagate_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Postorder traverse (left, right, root)
through the tree and calculate confidence
bounds on base nodes,
then propagate bounds using propagation logic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seldonian.parse_tree.parse_tree.ParseTree.reset_base_node_dict">
<span class="sig-name descname"><span class="pre">reset_base_node_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reset_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seldonian.parse_tree.parse_tree.ParseTree.reset_base_node_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset base node dict to initial state</p>
<dl class="simple">
<dt>reset_data<span class="classifier">bool</span></dt><dd><p>Whether to reset the cached data 
for each base node. This is needed less frequently
than one needs to reset the bounds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Seldonian Engine</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="seldonian.html">seldonian</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="seldonian.candidate_selection.html">seldonian.candidate_selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="seldonian.dataset.html">seldonian.dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="seldonian.models.html">seldonian.models</a></li>
<li class="toctree-l3"><a class="reference internal" href="seldonian.optimizers.html">seldonian.optimizers</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="seldonian.parse_tree.html">seldonian.parse_tree</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="seldonian.parse_tree.constraints.html">seldonian.parse_tree.constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="seldonian.parse_tree.nodes.html">seldonian.parse_tree.nodes</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="seldonian.parse_tree.parse_tree.html">seldonian.parse_tree.parse_tree</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">seldonian.parse_tree.parse_tree.ParseTree</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="seldonian.safety_test.html">seldonian.safety_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="seldonian.seldonian_algorithm.html">seldonian.seldonian_algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="seldonian.spec.html">seldonian.spec</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">API</a><ul>
  <li><a href="seldonian.html">seldonian</a><ul>
  <li><a href="seldonian.parse_tree.html">seldonian.parse_tree</a><ul>
  <li><a href="seldonian.parse_tree.parse_tree.html">seldonian.parse_tree.parse_tree</a><ul>
      <li>Previous: <a href="seldonian.parse_tree.parse_tree.html" title="previous chapter">seldonian.parse_tree.parse_tree</a></li>
      <li>Next: <a href="seldonian.safety_test.html" title="next chapter">seldonian.safety_test</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, University of Massachusetts, Amherst.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/_autosummary/seldonian.parse_tree.parse_tree.ParseTree.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>